<!DOCTYPE html>
<html>
<head>
    <title>Google Sheets Database</title>
</head>
<body>
    <h1>Google Sheets Database Setup</h1>
    
    <h2>Step 1: Buat Google Sheet</h2>
    <p>1. Buka <a href="https://sheets.new" target="_blank">sheets.new</a></p>
    <p>2. Buat sheet dengan nama "7Kebiasaan Database"</p>
    <p>3. Sheet 1: "Users", Sheet 2: "Habits"</p>
    
    <h2>Step 2: Dapatkan Sheet ID</h2>
    <p>URL Sheet: https://docs.google.com/spreadsheets/d/<strong>SHEET_ID</strong>/edit</p>
    <input type="text" id="sheetId" placeholder="Masukkan Sheet ID">
    
    <h2>Step 3: Simpan Data</h2>
    <button onclick="saveToGoogleSheets()">ðŸ’¾ Save to Google Sheets</button>
    <button onclick="loadFromGoogleSheets()">ðŸ“¥ Load from Google Sheets</button>
    
    <script>
        // Simple Google Sheets API (menggunakan Google Apps Script)
        async function saveToGoogleSheets() {
            const sheetId = document.getElementById('sheetId').value;
            if (!sheetId) {
                alert('Masukkan Sheet ID dulu');
                return;
            }
            
            const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            const habits = JSON.parse(localStorage.getItem('habitsData') || '[]');
            
            // Convert to CSV
            const usersCSV = convertToCSV(users);
            const habitsCSV = convertToCSV(habits);
            
            // Save to localStorage for backup
            localStorage.setItem('lastSheetId', sheetId);
            localStorage.setItem('lastSync', new Date().toISOString());
            
            alert('âœ… Data siap disimpan ke Google Sheets!\n\nBuka Google Sheets dan paste data CSV ke sheet yang sesuai.');
            
            // Show data untuk copy-paste
            showDataForCopy(usersCSV, habitsCSV);
        }
        
        function convertToCSV(data) {
            if (data.length === 0) return '';
            
            const headers = Object.keys(data[0]);
            const rows = data.map(item => 
                headers.map(header => 
                    JSON.stringify(item[header] || '')
                ).join(',')
            );
            
            return [headers.join(','), ...rows].join('\n');
        }
        
        function showDataForCopy(usersCSV, habitsCSV) {
            const container = document.createElement('div');
            container.style.cssText = `
                position: fixed; top: 50px; left: 50px; right: 50px; bottom: 50px;
                background: white; padding: 20px; border: 2px solid #4b6cb7;
                border-radius: 10px; z-index: 1000; overflow: auto;
            `;
            
            container.innerHTML = `
                <h3>ðŸ“‹ Data untuk Copy ke Google Sheets</h3>
                <button onclick="this.parentElement.remove()" style="float: right;">âœ• Tutup</button>
                
                <h4>Users Data (paste di Sheet "Users"):</h4>
                <textarea style="width: 100%; height: 200px; font-family: monospace;">${usersCSV}</textarea>
                
                <h4>Habits Data (paste di Sheet "Habits"):</h4>
                <textarea style="width: 100%; height: 200px; font-family: monospace;">${habitsCSV}</textarea>
                
                <p><strong>Cara:</strong> Select semua text â†’ Copy â†’ Buka Google Sheets â†’ Paste</p>
            `;
            
            document.body.appendChild(container);
        }
    </script>
</body>
</html>
